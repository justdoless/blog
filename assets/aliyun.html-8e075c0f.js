import{_ as l}from"./plugin-vue_export-helper-c27b6911.js";import{r as t,o as d,c,d as e,e as a,b as n,f as i}from"./app-251c4a71.js";const r={},o=i(`<h1 id="云服务器-安全组-防火墙-systemctl-等" tabindex="-1"><a class="header-anchor" href="#云服务器-安全组-防火墙-systemctl-等" aria-hidden="true">#</a> 云服务器：安全组 防火墙 systemctl 等</h1><blockquote><p>1、解决云服务器配置安全组端口后还是无法访问</p><p>2、使用系统自带的 systemctl 命令管理服务</p></blockquote><h2 id="_1-查看linux操作系统信息" tabindex="-1"><a class="header-anchor" href="#_1-查看linux操作系统信息" aria-hidden="true">#</a> 1. 查看linux操作系统信息</h2><blockquote><p>安装的软件和系统信息关联时关注</p></blockquote><h3 id="_1-1-查看linux内核版本命令-两种方法" tabindex="-1"><a class="header-anchor" href="#_1-1-查看linux内核版本命令-两种方法" aria-hidden="true">#</a> 1.1. 查看Linux内核版本命令（两种方法）</h3><p>1、<code>cat /proc/version</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /proc/version</span>
Linux version <span class="token number">2.6</span>.18-194.8.1.el5.centos.plus <span class="token punctuation">(</span>mockbuild@builder17.centos.org<span class="token punctuation">)</span> <span class="token punctuation">(</span>gcc version <span class="token number">4.1</span>.2 <span class="token number">20080704</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.1</span>.2-48<span class="token punctuation">))</span> <span class="token comment">#1 SMP Wed Jul 7 11:50:45 EDT 2010</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2、<code>uname -a</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># uname -a</span>
Linux localhost.localdomain <span class="token number">2.6</span>.18-194.8.1.el5.centos.plus <span class="token comment">#1 SMP Wed Jul 7 11:50:45 EDT 2010 i686 i686 i386 GNU/Linux</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-2-查看linux系统版本的命令-3种方法" tabindex="-1"><a class="header-anchor" href="#_1-2-查看linux系统版本的命令-3种方法" aria-hidden="true">#</a> 1.2. 查看Linux系统版本的命令（3种方法）</h3><p>1、<code>lsb_release -a</code>，即可列出所有版本信息：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># lsb_release -a</span>
LSB Version: :core-3.1-ia32:core-3.1-noarch:graphics-3.1-ia32:graphics-3.1-noarch
Distributor ID: CentOS
Description: CentOS release <span class="token number">5.5</span> <span class="token punctuation">(</span>Final<span class="token punctuation">)</span>
Release: <span class="token number">5.5</span>
Codename: Final
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个命令适用于所有的Linux发行版，包括Redhat、SuSE、Debian…等发行版。</p><p>2、<code>cat /etc/redhat-release</code>，这种方法只适合Redhat系的Linux：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/redhat-release</span>
CentOS release <span class="token number">5.5</span> <span class="token punctuation">(</span>Final<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3、<code>cat /etc/issue</code>，此命令也适用于所有的Linux发行版。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/issue</span>
CentOS release <span class="token number">5.5</span> <span class="token punctuation">(</span>Final<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-systemctl-服务进程自启动管理" tabindex="-1"><a class="header-anchor" href="#_2-systemctl-服务进程自启动管理" aria-hidden="true">#</a> 2. systemctl 服务进程自启动管理</h2><blockquote><p>使用系统自带的 systemctl 命令管理服务。</p></blockquote><ul><li>service配置文件 <ul><li>具体路径参考最新的配置要求: <code>/usr/lib/systemd/system/nodejs.service</code></li></ul></li><li>nodejs.service 文件权限设置777可执行权限</li></ul><h3 id="_2-1-常用命令" tabindex="-1"><a class="header-anchor" href="#_2-1-常用命令" aria-hidden="true">#</a> 2.1. 常用命令</h3><ul><li>systemctl daemon-reload 重置配置文件</li><li>systemctl start nodejs.service 启动服务</li><li>systemctl restart nodejs.service 启动服务</li><li>systemctl status nodejs.service 查看服务状态</li><li>systemctl enable nodejs.service 开机自启动服务</li></ul><h3 id="_2-2-nodejs" tabindex="-1"><a class="header-anchor" href="#_2-2-nodejs" aria-hidden="true">#</a> 2.2. nodejs</h3><blockquote><p>nodejs.service 配置参考</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>koa Server Service

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">User</span><span class="token operator">=</span>root
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>15s

<span class="token assign-left variable">WorkingDirectory</span><span class="token operator">=</span>/home/nodejs_koa
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/home/nodejs_koa/systemd.sh


<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,25),p={href:"http://systemd.sh",target:"_blank",rel:"noopener noreferrer"},u=i(`<blockquote><p>service 文件中直接配置 <code>ExecStart=npm start</code> 报错：无法使用全局的npm命令</p></blockquote><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">.</span> /root/.nvm/nvm.sh

<span class="token function">npm</span> start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-3-frp自启动服务" tabindex="-1"><a class="header-anchor" href="#_2-3-frp自启动服务" aria-hidden="true">#</a> 2.3. frp自启动服务</h3><ul><li>frps.service</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Frp Server Service
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>simple
<span class="token assign-left variable">User</span><span class="token operator">=</span>nobody
<span class="token assign-left variable">Restart</span><span class="token operator">=</span>on-failure
<span class="token assign-left variable">RestartSec</span><span class="token operator">=</span>5s
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/frp/frps <span class="token parameter variable">-c</span> /usr/local/frp/frps.ini
<span class="token assign-left variable">LimitNOFILE</span><span class="token operator">=</span><span class="token number">1048576</span>

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-开启或关闭linux实例中的系统防火墙" tabindex="-1"><a class="header-anchor" href="#_3-开启或关闭linux实例中的系统防火墙" aria-hidden="true">#</a> 3. 开启或关闭Linux实例中的系统防火墙</h2><p>防火墙是可以帮助计算机在内部网络和外部网络之间构建一道相对隔绝的保护屏障，从而保护数据信息的一种技术。如果服务器开启了防火墙，并设置了屏蔽外界访问的规则，那么在远程连接该服务器时，可能会导致访问失败。本文主要介绍在Linux操作系统中，如何开启或关闭系统防火墙。</p><blockquote><p>阿里云提醒您：</p><ul><li>如果您对实例或数据有修改、变更等风险操作，务必注意实例的容灾、容错能力，确保数据安全。</li><li>如果您对实例（包括但不限于ECS、RDS）等进行配置与数据修改，建议提前创建快照或开启RDS日志备份等功能。</li><li>如果您在阿里云平台授权或者提交过登录账号、密码等安全信息，建议您及时修改。</li></ul></blockquote><p>Linux系统存在不同的发行版本，不同发行版本中开启或关闭系统防火墙的命令不同，请根据现场环境匹配下列发行版本的操作命令。</p><h3 id="_3-1-centos-5-centos-6" tabindex="-1"><a class="header-anchor" href="#_3-1-centos-5-centos-6" aria-hidden="true">#</a> 3.1. CentOS 5/CentOS 6</h3><p>在CentOS 5和CentOS 6系统中，关于如何开启防火墙、关闭防火墙、查看防火墙运行状态，请参考以下信息：</p><ul><li>开启防火墙</li><li>关闭防火墙</li><li>查看防火墙运行状态</li></ul><h3 id="_3-2-centos-7-red-hat-7-alibaba-cloud-linux-2" tabindex="-1"><a class="header-anchor" href="#_3-2-centos-7-red-hat-7-alibaba-cloud-linux-2" aria-hidden="true">#</a> 3.2. CentOS 7/Red Hat 7/Alibaba Cloud Linux 2</h3><p>在CentOS 7、Red Hat和Alibaba Cloud Linux 2<br> 系统中，关于如何开启防火墙、关闭防火墙、查看防火墙运行状态，请参考以下信息：</p><ul><li><p>开启防火墙</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl start firewalld.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>关闭防火墙</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl stop firewalld.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>查看防火墙运行状态</p></li></ul><h3 id="_3-3-ubuntu" tabindex="-1"><a class="header-anchor" href="#_3-3-ubuntu" aria-hidden="true">#</a> 3.3. Ubuntu</h3><p>在Ubuntu系统中，关于如何开启防火墙、关闭防火墙、查看防火墙运行状态，请参考以下信息：</p><ul><li>开启防火墙</li><li>关闭防火墙</li><li>查看防火墙运行状态</li></ul><h3 id="_3-4-debian" tabindex="-1"><a class="header-anchor" href="#_3-4-debian" aria-hidden="true">#</a> 3.4. Debian</h3><p>在Debian系统中，默认没有安装防火墙，可以通过清空防火墙策略，删除相关屏蔽规则。具体操作如下所示：</p><blockquote><p><strong>注意</strong>：清空策略前，请务必备份防火墙策略。</p></blockquote><ol><li><p>依次执行以下命令，备份防火墙策略。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">touch</span> <span class="token punctuation">[</span><span class="token variable">$Iptables</span><span class="token punctuation">]</span>iptables-save <span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token variable">$Iptables</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p><strong>说明</strong>：[$Iptables]为防火墙策略的备份文件地址。</p></blockquote></li><li><p>执行以下命令，清空防火墙策略。</p></li></ol><h2 id="_4-添加-删除防火墙端口" tabindex="-1"><a class="header-anchor" href="#_4-添加-删除防火墙端口" aria-hidden="true">#</a> 4. 添加/删除防火墙端口</h2><blockquote><p>云服务器配置安全组后还是无法访问时，需要配置防火墙端口</p></blockquote><h3 id="_4-1-查看所有信息-看添加的端口是否存在-注-ports后面的就是开放的对应端口" tabindex="-1"><a class="header-anchor" href="#_4-1-查看所有信息-看添加的端口是否存在-注-ports后面的就是开放的对应端口" aria-hidden="true">#</a> 4.1. 查看所有信息，看添加的端口是否存在（注：ports后面的就是开放的对应端口）</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># firewall-cmd --list-all  #注意权限问题
public (active)
target: default
icmp-block-inversion: no
interfaces: eth0
sources:
services: dhcpv6-client
ports: 1130/tcp 80/tcp 10051/tcp 5672/tcp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2）没有的话添加，例如添加18002端口</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#firewall-cmd --zone=public --add-port=18002/tcp --permanent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>说明：</p><p>–zone #作用域</p><p>–add-port=80/tcp #添加端口，格式为：端口/通讯协议</p><p>–permanent 永久生效，没有此参数重启后失效</p><h3 id="_4-2-其它操作" tabindex="-1"><a class="header-anchor" href="#_4-2-其它操作" aria-hidden="true">#</a> 4.2. 其它操作</h3><p>添加多个端口:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>firewall-cmd --zone=public --add-port=80-90/tcp --permanent
#删除
firewall-cmd --zone=public --remove-port=80/tcp --permanent
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>3）重启防火墙</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>#firewall-cmd --reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>4）再次查看端口是否打开（如打开后，则完美解决）</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># firewall-cmd --list-all
public (active)
target: default
icmp-block-inversion: no
interfaces: eth0
sources:
services: dhcpv6-client
ports: 1130/tcp 80/tcp 10051/tcp 18002/tcp 7660/tcp
protocols:
masquerade: yes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-防火墙的一些基本命令" tabindex="-1"><a class="header-anchor" href="#_4-3-防火墙的一些基本命令" aria-hidden="true">#</a> 4.3. 防火墙的一些基本命令</h3><p>1:查看防火状态</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl status firewalld
service iptables status
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2:暂时关闭防火墙</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl stop firewalld
service iptables stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3:永久关闭防火墙</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl disable firewalld
chkconfig iptables off
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>4:重启防火墙</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>systemctl enable firewalld
service iptables restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>5：启动防火墙</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>sudo systemctl start firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="_5-参考" tabindex="-1"><a class="header-anchor" href="#_5-参考" aria-hidden="true">#</a> 5. 参考</h2>`,51),v={href:"https://help.aliyun.com/document_detail/175507.html",target:"_blank",rel:"noopener noreferrer"};function b(m,h){const s=t("ExternalLinkIcon");return d(),c("div",null,[o,e("ul",null,[e("li",null,[e("a",p,[a("systemd.sh"),n(s)]),a(" 文件配置")])]),u,e("ul",null,[e("li",null,[e("a",v,[a("https://help.aliyun.com/document_detail/175507.html"),n(s)])])])])}const x=l(r,[["render",b],["__file","aliyun.html.vue"]]);export{x as default};
