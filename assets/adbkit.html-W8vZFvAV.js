const n=JSON.parse(`{"key":"v-3541625a","path":"/posts/dev/adbkit.html","title":"adbKit 调试","lang":"zh-CN","frontmatter":{"date":"2023-05-05T00:00:00.000Z","icon":"note","category":["dev"],"tag":["adb","adbkit","debug"],"description":"adbKit 调试 基础用法 cat: 读取文件到控制台。 grep: 搜索包含对应字符串的文件数据。 可以加参数控制 1. demos const webviewInfo = ({tcpPort = 4000, prefix = 'webview', filter = d =&gt; d} = {}) =&gt; { if (prefix === '*') { prefix = '.+'; } let re = new RegExp('@(' + prefix + '_devtools_remote(?:_\\\\\\\\d+)?)', 'gi'); return getDeviceId().then(deviceId =&gt; { // return adbKit.shell(deviceId, 'cat /proc/net/unix | grep _devtools_remote') .then(adb.util.readAll) .then(output =&gt; { let remotePorts = new Set(); output.toString().replace(re, (_, port) =&gt; { remotePorts.add(port); }); if (remotePorts.size) { return [...remotePorts]; } else { throw new Error('没有启动 webview'); } }) .then(ports =&gt; getForwardPortInfo({deviceId, ports, tcpPort, filter})) }); };","head":[["meta",{"property":"og:url","content":"https://justdoless.cn/posts/dev/adbkit.html"}],["meta",{"property":"og:site_name","content":"blog"}],["meta",{"property":"og:title","content":"adbKit 调试"}],["meta",{"property":"og:description","content":"adbKit 调试 基础用法 cat: 读取文件到控制台。 grep: 搜索包含对应字符串的文件数据。 可以加参数控制 1. demos const webviewInfo = ({tcpPort = 4000, prefix = 'webview', filter = d =&gt; d} = {}) =&gt; { if (prefix === '*') { prefix = '.+'; } let re = new RegExp('@(' + prefix + '_devtools_remote(?:_\\\\\\\\d+)?)', 'gi'); return getDeviceId().then(deviceId =&gt; { // return adbKit.shell(deviceId, 'cat /proc/net/unix | grep _devtools_remote') .then(adb.util.readAll) .then(output =&gt; { let remotePorts = new Set(); output.toString().replace(re, (_, port) =&gt; { remotePorts.add(port); }); if (remotePorts.size) { return [...remotePorts]; } else { throw new Error('没有启动 webview'); } }) .then(ports =&gt; getForwardPortInfo({deviceId, ports, tcpPort, filter})) }); };"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-11T11:34:34.000Z"}],["meta",{"property":"article:author","content":"justdoless"}],["meta",{"property":"article:tag","content":"adb"}],["meta",{"property":"article:tag","content":"adbkit"}],["meta",{"property":"article:tag","content":"debug"}],["meta",{"property":"article:published_time","content":"2023-05-05T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-01-11T11:34:34.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"adbKit 调试\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-05-05T00:00:00.000Z\\",\\"dateModified\\":\\"2024-01-11T11:34:34.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"justdoless\\",\\"url\\":\\"https://justdoless.cn\\",\\"email\\":\\"justdoless.com@gmail.com\\"}]}"]]},"headers":[{"level":2,"title":"1. demos","slug":"_1-demos","link":"#_1-demos","children":[]},{"level":2,"title":"2. 参考","slug":"_2-参考","link":"#_2-参考","children":[]}],"git":{"createdTime":1704972874000,"updatedTime":1704972874000,"contributors":[{"name":"xgwang","email":"xgwang@sysnew.com","commits":1}]},"readingTime":{"minutes":0.43,"words":130},"filePathRelative":"posts/dev/adbkit.md","localizedDate":"2023年5月5日","excerpt":"<h1> adbKit 调试</h1>\\n<blockquote>\\n<p>基础用法</p>\\n</blockquote>\\n<ul>\\n<li>cat: 读取文件到控制台。</li>\\n<li>grep: 搜索包含对应字符串的文件数据。\\n<ul>\\n<li>可以加参数控制</li>\\n</ul>\\n</li>\\n</ul>\\n<h2> 1. demos</h2>\\n<div class=\\"language-javascript line-numbers-mode\\" data-ext=\\"js\\"><pre class=\\"language-javascript\\"><code><span class=\\"token keyword\\">const</span> webviewInfo <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">{</span>tcpPort <span class=\\"token operator\\">=</span> <span class=\\"token number\\">4000</span><span class=\\"token punctuation\\">,</span> prefix <span class=\\"token operator\\">=</span> <span class=\\"token string\\">'webview'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token function-variable function\\">filter</span> <span class=\\"token operator\\">=</span> <span class=\\"token parameter\\">d</span> <span class=\\"token operator\\">=&gt;</span> d<span class=\\"token punctuation\\">}</span> <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">{</span><span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n\\n    <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>prefix <span class=\\"token operator\\">===</span> <span class=\\"token string\\">'*'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n        prefix <span class=\\"token operator\\">=</span> <span class=\\"token string\\">'.+'</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token punctuation\\">}</span>\\n    <span class=\\"token keyword\\">let</span> re <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">RegExp</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'@('</span> <span class=\\"token operator\\">+</span> prefix <span class=\\"token operator\\">+</span> <span class=\\"token string\\">'_devtools_remote(?:_\\\\\\\\d+)?)'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">'gi'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token keyword\\">return</span> <span class=\\"token function\\">getDeviceId</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">then</span><span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">deviceId</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n        <span class=\\"token comment\\">// </span>\\n        <span class=\\"token keyword\\">return</span> adbKit<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">shell</span><span class=\\"token punctuation\\">(</span>deviceId<span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">'cat /proc/net/unix | grep _devtools_remote'</span><span class=\\"token punctuation\\">)</span>\\n            <span class=\\"token punctuation\\">.</span><span class=\\"token function\\">then</span><span class=\\"token punctuation\\">(</span>adb<span class=\\"token punctuation\\">.</span>util<span class=\\"token punctuation\\">.</span>readAll<span class=\\"token punctuation\\">)</span>\\n            <span class=\\"token punctuation\\">.</span><span class=\\"token function\\">then</span><span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">output</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n                <span class=\\"token keyword\\">let</span> remotePorts <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">Set</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                output<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">toString</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">replace</span><span class=\\"token punctuation\\">(</span>re<span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">_<span class=\\"token punctuation\\">,</span> port</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n                    remotePorts<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">add</span><span class=\\"token punctuation\\">(</span>port<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>remotePorts<span class=\\"token punctuation\\">.</span>size<span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n                    <span class=\\"token keyword\\">return</span> <span class=\\"token punctuation\\">[</span><span class=\\"token operator\\">...</span>remotePorts<span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">;</span>\\n                <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">else</span> <span class=\\"token punctuation\\">{</span>\\n                    <span class=\\"token keyword\\">throw</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">Error</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'没有启动 webview'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n                <span class=\\"token punctuation\\">}</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n            <span class=\\"token punctuation\\">.</span><span class=\\"token function\\">then</span><span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">ports</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token function\\">getForwardPortInfo</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">{</span>deviceId<span class=\\"token punctuation\\">,</span> ports<span class=\\"token punctuation\\">,</span> tcpPort<span class=\\"token punctuation\\">,</span> filter<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">;</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","copyright":{"author":"justdoless.com@gmail.com"},"autoDesc":true}`);export{n as data};
