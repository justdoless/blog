import{_ as a,X as t,Y as p,a0 as n,a1 as e,$ as o,a2 as c,C as l}from"./framework-9d02e721.js";const i={},u=c(`<h1 id="adb调试" tabindex="-1"><a class="header-anchor" href="#adb调试" aria-hidden="true">#</a> adb调试</h1><blockquote><p>基础用法</p></blockquote><ul><li>cat: 读取文件到控制台。</li><li>grep: 搜索包含对应字符串的文件数据。 <ul><li>可以加参数控制</li></ul></li></ul><h2 id="demos" tabindex="-1"><a class="header-anchor" href="#demos" aria-hidden="true">#</a> demos</h2><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> webviewInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>tcpPort <span class="token operator">=</span> <span class="token number">4000</span><span class="token punctuation">,</span> prefix <span class="token operator">=</span> <span class="token string">&#39;webview&#39;</span><span class="token punctuation">,</span> <span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token parameter">d</span> <span class="token operator">=&gt;</span> d<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>prefix <span class="token operator">===</span> <span class="token string">&#39;*&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        prefix <span class="token operator">=</span> <span class="token string">&#39;.+&#39;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> re <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&#39;@(&#39;</span> <span class="token operator">+</span> prefix <span class="token operator">+</span> <span class="token string">&#39;_devtools_remote(?:_\\\\d+)?)&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;gi&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">getDeviceId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">deviceId</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// </span>
        <span class="token keyword">return</span> adbKit<span class="token punctuation">.</span><span class="token function">shell</span><span class="token punctuation">(</span>deviceId<span class="token punctuation">,</span> <span class="token string">&#39;cat /proc/net/unix | grep _devtools_remote&#39;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>adb<span class="token punctuation">.</span>util<span class="token punctuation">.</span>readAll<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">output</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">let</span> remotePorts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                output<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>re<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> port</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                    remotePorts<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>remotePorts<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>remotePorts<span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&#39;没有启动 webview&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">ports</span> <span class="token operator">=&gt;</span> <span class="token function">getForwardPortInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>deviceId<span class="token punctuation">,</span> ports<span class="token punctuation">,</span> tcpPort<span class="token punctuation">,</span> filter<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2>`,6),r={href:"https://www.runoob.com/linux/linux-command-manual.html",target:"_blank",rel:"noopener noreferrer"};function k(d,v){const s=l("ExternalLinkIcon");return t(),p("div",null,[u,n("ul",null,[n("li",null,[n("a",r,[e("https://www.runoob.com/linux/linux-command-manual.html"),o(s)])])])])}const b=a(i,[["render",k],["__file","adbkit.html.vue"]]);export{b as default};
